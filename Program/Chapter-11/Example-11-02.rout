
R version 2.6.1 (2007-11-26)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

>  mydata = read.table("http://www.ces.clemson.edu/~cspark/805/data/CH11TA01.txt")
> 
>  x = mydata[,1] ;  y = mydata[,2]
> 
>  LM = lm ( y ~ x )
> 
>  summary(LM)

Call:
lm(formula = y ~ x)

Residuals:
      Min        1Q    Median        3Q       Max 
-16.47859  -5.78765  -0.07844   5.61173  19.78132 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 56.15693    3.99367  14.061  < 2e-16 ***
x            0.58003    0.09695   5.983 2.05e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 8.146 on 52 degrees of freedom
Multiple R-Squared: 0.4077,	Adjusted R-squared: 0.3963 
F-statistic: 35.79 on 1 and 52 DF,  p-value: 2.050e-07 

> 
>  c3 = resid(LM)
>  c4 = fitted(LM)
> 
>  c5 = abs (c3)
> 
>  LM2 = lm ( c5 ~ x )
>  c6  = fitted (LM2)
>  
>  c7 = 1/c6
>  c8 = c7 * c7
> 
>  cbind(x, y, c3, c5, c6, c8)
    x   y          c3         c5        c6          c8
1  27  73   1.1822391  1.1822391  3.801175 0.069209280
2  21  66  -2.3375761  2.3375761  2.612141 0.146557083
3  22  63  -5.9176069  5.9176069  2.810313 0.126616574
4  24  75   4.9223315  4.9223315  3.206658 0.097251155
5  25  71   0.3423007  0.3423007  3.404830 0.086259931
6  23  70   0.5023623  0.5023623  3.008485 0.110485213
7  20  65  -2.7575453  2.7575453  2.413969 0.171607704
8  20  70   2.2424547  2.2424547  2.413969 0.171607704
9  29  79   6.0221775  6.0221775  4.197519 0.056756367
10 24  72   1.9223315  1.9223315  3.206658 0.097251155
11 25  68  -2.6576993  2.6576993  3.404830 0.086259931
12 28  67  -5.3977917  5.3977917  3.999347 0.062520410
13 26  79   7.7622699  7.7622699  3.603002 0.077031950
14 38  91  12.8019003 12.8019003  5.981070 0.027953887
15 32  76   1.2820851  1.2820851  4.792036 0.043547157
16 33  69  -6.2979457  6.2979457  4.990209 0.040157124
17 31  66  -8.1378841  8.1378841  4.593864 0.047385311
18 34  73  -2.8779765  2.8779765  5.188381 0.037148074
19 37  78   0.3819311  0.3819311  5.782898 0.029902601
20 38  87   8.8019003  8.8019003  5.981070 0.027953887
21 33  76   0.7020543  0.7020543  4.990209 0.040157124
22 35  79   2.5419927  2.5419927  5.386553 0.034464985
23 30  73  -0.5578533  0.5578533  4.395692 0.051754195
24 31  80   5.8621159  5.8621159  4.593864 0.047385311
25 37  68  -9.6180689  9.6180689  5.782898 0.029902601
26 39  75  -3.7781305  3.7781305  6.179242 0.026189640
27 46  89   6.1616539  6.1616539  7.566449 0.017466900
28 49 101  16.4215616 16.4215616  8.160966 0.015014709
29 40  70  -9.3581613  9.3581613  6.377415 0.024587291
30 42  72  -8.5182229  8.5182229  6.773759 0.021794177
31 43  80  -1.0982537  1.0982537  6.971932 0.020572817
32 46  83   0.1616539  0.1616539  7.566449 0.017466900
33 43  75  -6.0982537  6.0982537  6.971932 0.020572817
34 44  71 -10.6782845 10.6782845  7.170104 0.019451321
35 46  80  -2.8383461  2.8383461  7.566449 0.017466900
36 47  96  12.5816232 12.5816232  7.764621 0.016586681
37 45  92   9.7416847  9.7416847  7.368276 0.018419091
38 49  80  -4.5784384  4.5784384  8.160966 0.015014709
39 48  70 -13.9984076 13.9984076  7.962793 0.015771359
40 40  90  10.6418387 10.6418387  6.377415 0.024587291
41 42  85   4.4817771  4.4817771  6.773759 0.021794177
42 55  76 -12.0586232 12.0586232  9.349999 0.011438704
43 54  71 -16.4785924 16.4785924  9.151827 0.011939452
44 57  99   9.7813152  9.7813152  9.746344 0.010527289
45 52  86  -0.3185308  0.3185308  8.755482 0.013044872
46 53  79  -7.8985616  7.8985616  8.953655 0.012473815
47 56  92   3.3613460  3.3613460  9.548172 0.010968811
48 52  85  -1.3185308  1.3185308  8.755482 0.013044872
49 50  71 -14.1584692 14.1584692  8.359138 0.014311232
50 59  90  -0.3787464  0.3787464 10.142689 0.009720617
51 50  91   5.8415308  5.8415308  8.359138 0.014311232
52 52 100  13.6814692 13.6814692  8.755482 0.013044872
53 58  80  -9.7987156  9.7987156  9.944516 0.010111898
54 57 109  19.7813152 19.7813152  9.746344 0.010527289
> 
> # -----------------------------------------------------------
> # WLS (using option in lm ( ) function)
> # -----------------------------------------------------------
>  WLS = lm ( y ~ x , weights = c8)
>  
>  summary (WLS)

Call:
lm(formula = y ~ x, weights = c8)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0230 -0.9939 -0.0327  0.9250  2.2008 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 55.56577    2.52092  22.042  < 2e-16 ***
x            0.59634    0.07924   7.526 7.19e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.213 on 52 degrees of freedom
Multiple R-Squared: 0.5214,	Adjusted R-squared: 0.5122 
F-statistic: 56.64 on 1 and 52 DF,  p-value: 7.187e-10 

> 
>  c9  = resid (WLS)
>  c10 = fitted (WLS)
> 
> # -----------------------------------------------------------
> # WLS (using OLS)
> # -----------------------------------------------------------
> c12 = c7 * x 
> c22 = c7 * y 
> 
>  LM2 = lm ( c22 ~ 0 + c7 + c12 )
>  c23 = fitted(LM2)
>  summary(LM2)

Call:
lm(formula = c22 ~ 0 + c7 + c12)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0230 -0.9939 -0.0327  0.9250  2.2008 

Coefficients:
    Estimate Std. Error t value Pr(>|t|)    
c7  55.56577    2.52092  22.042  < 2e-16 ***
c12  0.59634    0.07924   7.526 7.19e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.213 on 52 degrees of freedom
Multiple R-Squared: 0.9939,	Adjusted R-squared: 0.9937 
F-statistic:  4229 on 2 and 52 DF,  p-value: < 2.2e-16 

> 
>  cbind(c10, c23)
        c10       c23
1  71.66699 18.853906
2  68.08894 26.066336
3  68.68528 24.440438
4  69.87797 21.791526
5  70.47431 20.698334
6  69.28163 23.028739
7  67.49260 27.959188
8  67.49260 27.959188
9  72.85968 17.357794
10 69.87797 21.791526
11 70.47431 20.698334
12 72.26333 18.068783
13 71.07065 19.725396
14 78.22675 13.079056
15 74.64870 15.577658
16 75.24504 15.078537
17 74.05236 16.119842
18 75.84138 14.617544
19 77.63041 13.424137
20 78.22675 13.079056
21 75.24504 15.078537
22 76.43773 14.190471
23 73.45602 16.710912
24 74.05236 16.119842
25 77.63041 13.424137
26 78.82309 12.756110
27 82.99749 10.969147
28 84.78651 10.389274
29 79.41943 12.453234
30 80.61212 11.900647
31 81.20846 11.647914
32 82.99749 10.969147
33 81.20846 11.647914
34 81.80480 11.409151
35 82.99749 10.969147
36 83.59383 10.765989
37 82.40114 11.183232
38 84.78651 10.389274
39 84.19017 10.572944
40 79.41943 12.453234
41 80.61212 11.900647
42 88.36456  9.450756
43 87.76822  9.590240
44 89.55724  9.188804
45 86.57554  9.888151
46 87.17188  9.735899
47 88.96090  9.317061
48 86.57554  9.888151
49 85.38285 10.214313
50 90.74993  8.947325
51 85.38285 10.214313
52 86.57554  9.888151
53 90.15359  9.065658
54 89.55724  9.188804
> 
>  c24 = c23/c7
> 
>  cbind(c10, c24)
        c10      c24
1  71.66699 71.66699
2  68.08894 68.08894
3  68.68528 68.68528
4  69.87797 69.87797
5  70.47431 70.47431
6  69.28163 69.28163
7  67.49260 67.49260
8  67.49260 67.49260
9  72.85968 72.85968
10 69.87797 69.87797
11 70.47431 70.47431
12 72.26333 72.26333
13 71.07065 71.07065
14 78.22675 78.22675
15 74.64870 74.64870
16 75.24504 75.24504
17 74.05236 74.05236
18 75.84138 75.84138
19 77.63041 77.63041
20 78.22675 78.22675
21 75.24504 75.24504
22 76.43773 76.43773
23 73.45602 73.45602
24 74.05236 74.05236
25 77.63041 77.63041
26 78.82309 78.82309
27 82.99749 82.99749
28 84.78651 84.78651
29 79.41943 79.41943
30 80.61212 80.61212
31 81.20846 81.20846
32 82.99749 82.99749
33 81.20846 81.20846
34 81.80480 81.80480
35 82.99749 82.99749
36 83.59383 83.59383
37 82.40114 82.40114
38 84.78651 84.78651
39 84.19017 84.19017
40 79.41943 79.41943
41 80.61212 80.61212
42 88.36456 88.36456
43 87.76822 87.76822
44 89.55724 89.55724
45 86.57554 86.57554
46 87.17188 87.17188
47 88.96090 88.96090
48 86.57554 86.57554
49 85.38285 85.38285
50 90.74993 90.74993
51 85.38285 85.38285
52 86.57554 86.57554
53 90.15359 90.15359
54 89.55724 89.55724
> 
> 
> 
